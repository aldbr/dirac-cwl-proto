{
  "$defs": {
    "ExecutionHooksBasePlugin": {
      "description": "Base metadata model for DIRAC jobs",
      "dirac_description": "Base metadata model",
      "dirac_vo": null,
      "properties": {},
      "title": "DIRAC Metadata Model",
      "type": "object"
    },
    "ExecutionHooksHint": {
      "additionalProperties": true,
      "description": "Data management configuration for DIRAC jobs",
      "properties": {
        "configuration": {
          "description": "Additional parameters for metadata plugins",
          "title": "Configuration",
          "type": "object"
        },
        "hook_plugin": {
          "default": "QueryBasedPlugin",
          "description": "Registry key for the metadata implementation class",
          "title": "Hook Plugin",
          "type": "string"
        }
      },
      "title": "DIRAC Data Manager",
      "type": "object"
    },
    "JobInputModel": {
      "description": "Input data and sandbox files for a job execution.",
      "properties": {
        "cwl": {
          "title": "Cwl",
          "type": "object"
        },
        "sandbox": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "title": "Sandbox"
        }
      },
      "required": [
        "sandbox",
        "cwl"
      ],
      "title": "JobInputModel",
      "type": "object"
    },
    "JobSubmissionModel": {
      "$defs": {
        "ExecutionHooksHint": {
          "additionalProperties": true,
          "description": "Data management configuration for DIRAC jobs",
          "properties": {
            "configuration": {
              "description": "Additional parameters for metadata plugins",
              "title": "Configuration",
              "type": "object"
            },
            "hook_plugin": {
              "default": "QueryBasedPlugin",
              "description": "Registry key for the metadata implementation class",
              "title": "Hook Plugin",
              "type": "string"
            }
          },
          "title": "DIRAC Data Manager",
          "type": "object"
        },
        "JobInputModel": {
          "description": "Input data and sandbox files for a job execution.",
          "properties": {
            "cwl": {
              "title": "Cwl",
              "type": "object"
            },
            "sandbox": {
              "anyOf": [
                {
                  "items": {
                    "type": "string"
                  },
                  "type": "array"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sandbox"
            }
          },
          "required": [
            "sandbox",
            "cwl"
          ],
          "title": "JobInputModel",
          "type": "object"
        },
        "SchedulingHint": {
          "additionalProperties": false,
          "description": "Descriptor for job execution configuration.",
          "properties": {
            "platform": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "default": null,
              "description": "Target platform (e.g., 'DIRAC', 'DIRACX')",
              "title": "Platform"
            },
            "priority": {
              "default": 10,
              "description": "Job priority (higher values = higher priority)",
              "title": "Priority",
              "type": "integer"
            },
            "sites": {
              "anyOf": [
                {
                  "items": {
                    "type": "string"
                  },
                  "type": "array"
                },
                {
                  "type": "null"
                }
              ],
              "default": null,
              "description": "Candidate execution sites",
              "title": "Sites"
            }
          },
          "title": "SchedulingHint",
          "type": "object"
        }
      },
      "description": "Job definition sent to the router.",
      "properties": {
        "execution_hooks": {
          "$ref": "#/$defs/ExecutionHooksHint"
        },
        "parameters": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/JobInputModel"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Parameters"
        },
        "scheduling": {
          "$ref": "#/$defs/SchedulingHint"
        },
        "task": {
          "anyOf": [],
          "title": "Task"
        }
      },
      "required": [
        "task",
        "scheduling",
        "execution_hooks"
      ],
      "title": "JobSubmissionModel",
      "type": "object"
    },
    "ProductionSubmissionModel": {
      "additionalProperties": false,
      "description": "Schema for ProductionSubmissionModel with CWL type references",
      "properties": {
        "steps_execution_hooks": {
          "additionalProperties": {
            "$ref": "#/$defs/TransformationExecutionHooksHint"
          },
          "description": "Dictionary mapping strings to TransformationExecutionHooksHint",
          "type": "object"
        },
        "steps_scheduling": {
          "additionalProperties": {
            "$ref": "#/$defs/SchedulingHint"
          },
          "description": "Dictionary mapping strings to SchedulingHint",
          "type": "object"
        },
        "task": {
          "$ref": "https://json.schemastore.org/cwl-workflow.json",
          "description": "CWL Workflow definition"
        }
      },
      "required": [
        "task",
        "steps_execution_hooks"
      ],
      "title": "ProductionSubmissionModel",
      "type": "object"
    },
    "QueryBasedPlugin": {
      "description": "Base metadata model for DIRAC jobs",
      "dirac_description": "LFN-based metadata for structured data discovery",
      "dirac_vo": null,
      "properties": {
        "campaign": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Campaign name for LFN path",
          "title": "Campaign"
        },
        "data_type": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Data type classification",
          "title": "Data Type"
        },
        "query_root": {
          "default": "/grid/data",
          "description": "Base path for LFN structure",
          "title": "Query Root",
          "type": "string"
        },
        "site": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Site identifier for LFN path",
          "title": "Site"
        }
      },
      "title": "DIRAC Metadata Model",
      "type": "object"
    },
    "SchedulingHint": {
      "additionalProperties": false,
      "description": "Descriptor for job execution configuration.",
      "properties": {
        "platform": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Target platform (e.g., 'DIRAC', 'DIRACX')",
          "title": "Platform"
        },
        "priority": {
          "default": 10,
          "description": "Job priority (higher values = higher priority)",
          "title": "Priority",
          "type": "integer"
        },
        "sites": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Candidate execution sites",
          "title": "Sites"
        }
      },
      "title": "SchedulingHint",
      "type": "object"
    },
    "TransformationExecutionHooksHint": {
      "additionalProperties": true,
      "description": "Data management configuration for DIRAC jobs",
      "properties": {
        "configuration": {
          "description": "Additional parameters for metadata plugins",
          "title": "Configuration",
          "type": "object"
        },
        "group_size": {
          "anyOf": [
            {
              "additionalProperties": {
                "type": "integer"
              },
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Input grouping configuration for transformation jobs",
          "title": "Group Size"
        },
        "hook_plugin": {
          "default": "QueryBasedPlugin",
          "description": "Registry key for the metadata implementation class",
          "title": "Hook Plugin",
          "type": "string"
        }
      },
      "title": "DIRAC Data Manager",
      "type": "object"
    },
    "TransformationSubmissionModel": {
      "$defs": {
        "SchedulingHint": {
          "additionalProperties": false,
          "description": "Descriptor for job execution configuration.",
          "properties": {
            "platform": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "default": null,
              "description": "Target platform (e.g., 'DIRAC', 'DIRACX')",
              "title": "Platform"
            },
            "priority": {
              "default": 10,
              "description": "Job priority (higher values = higher priority)",
              "title": "Priority",
              "type": "integer"
            },
            "sites": {
              "anyOf": [
                {
                  "items": {
                    "type": "string"
                  },
                  "type": "array"
                },
                {
                  "type": "null"
                }
              ],
              "default": null,
              "description": "Candidate execution sites",
              "title": "Sites"
            }
          },
          "title": "SchedulingHint",
          "type": "object"
        },
        "TransformationExecutionHooksHint": {
          "additionalProperties": true,
          "description": "Data management configuration for DIRAC jobs",
          "properties": {
            "configuration": {
              "description": "Additional parameters for metadata plugins",
              "title": "Configuration",
              "type": "object"
            },
            "group_size": {
              "anyOf": [
                {
                  "additionalProperties": {
                    "type": "integer"
                  },
                  "type": "object"
                },
                {
                  "type": "null"
                }
              ],
              "default": null,
              "description": "Input grouping configuration for transformation jobs",
              "title": "Group Size"
            },
            "hook_plugin": {
              "default": "QueryBasedPlugin",
              "description": "Registry key for the metadata implementation class",
              "title": "Hook Plugin",
              "type": "string"
            }
          },
          "title": "DIRAC Data Manager",
          "type": "object"
        }
      },
      "description": "Transformation definition sent to the router.",
      "properties": {
        "execution_hooks": {
          "$ref": "#/$defs/TransformationExecutionHooksHint"
        },
        "scheduling": {
          "$ref": "#/$defs/SchedulingHint"
        },
        "task": {
          "anyOf": [],
          "title": "Task"
        }
      },
      "required": [
        "task",
        "execution_hooks",
        "scheduling"
      ],
      "title": "TransformationSubmissionModel",
      "type": "object"
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#",
  "additionalProperties": false,
  "description": "Complete schema for DIRAC CWL metadata including all registered plugins",
  "properties": {
    "description": {
      "allOf": [
        {
          "$ref": "#/$defs/TaskDescriptor"
        }
      ],
      "description": "Task description and execution parameters",
      "type": "object"
    },
    "metadata": {
      "allOf": [
        {
          "$ref": "#/$defs/MetadataDescriptor"
        }
      ],
      "description": "Metadata descriptor for the task",
      "type": "object"
    }
  },
  "title": "DIRAC Metadata Schema",
  "type": "object"
}
